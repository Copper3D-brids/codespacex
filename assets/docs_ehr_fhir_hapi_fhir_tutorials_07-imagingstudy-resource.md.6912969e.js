import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.f9076d03.js";const p=JSON.parse('{"title":"Tutorial - FHIR ImagingStudy Resource","description":"","frontmatter":{},"headers":[],"relativePath":"docs/ehr/fhir/hapi_fhir/tutorials/07-imagingstudy-resource.md","filePath":"docs/ehr/fhir/hapi_fhir/tutorials/07-imagingstudy-resource.md","lastUpdated":1702526618000}'),e={name:"docs/ehr/fhir/hapi_fhir/tutorials/07-imagingstudy-resource.md"},o=[l('<h1 id="tutorial-fhir-imagingstudy-resource" tabindex="-1">Tutorial - FHIR ImagingStudy Resource <a class="header-anchor" href="#tutorial-fhir-imagingstudy-resource" aria-label="Permalink to &quot;Tutorial - FHIR ImagingStudy Resource&quot;">​</a></h1><ul><li><p>Tutorial code on GitHub <a href="https://github.com/Copper3D-brids/hapi-py-fhir-tutorials/blob/main/imagingStudyOperator.py" target="_blank" rel="noreferrer">hapi-py-fhir-tutorials -- imagingStudyOperator.py</a>.</p></li><li><p>Currently, it is a <strong>private</strong> repository, will open source later...</p></li></ul><h2 id="background" tabindex="-1">Background <a class="header-anchor" href="#background" aria-label="Permalink to &quot;Background&quot;">​</a></h2><h3 id="scenario" tabindex="-1">Scenario <a class="header-anchor" href="#scenario" aria-label="Permalink to &quot;Scenario&quot;">​</a></h3><p>Volunteers Aniyah and Linman recently had breast and heart MRIs taken at the Akron Hospital.The researcher at BioResearch Institute stored the collected MRI data in SPARC SDS datasets. As shown in the figure below, the researcher stored Aniyah and Linman&#39;s breast MRIs under the <code>primary</code> folder in the breast dataset, respectively.</p><p><img src="/codespacex/fhir/01-fhir-resources/04-sparc-imagingstudy-relationship.png" alt="sparc imagingstudy relationship"></p><p>This figure shows the correspondence between the SPARC SDS dataset and the FHIR ImagingStudy Resource. From the figure we can see that each <code>subject/study</code> under the <code>primary</code> folder corresponds to an <code>ImagingStudy object</code>. The <code>sample</code> folder under each subject folder corresponds to the elements of the <code>Series array</code> of the ImagingStudy object. More over, the <code>dicom files</code> under each sample folder are stored one by one in the <code>ImagingStudy.Series.Instance</code> array.</p><p>After we understand the relationship between <code>SPARC SDS dataset</code> and <code>FHIR ImagingStudy Resource</code>, now we can build the FHIR ImagingStudy resources for Aniyah and Linman. Below image shows how we create the SPARC SDS dataset and FHIR resources. From image we can understand, the Aniyah and Linman&#39;s breast and heart MRIs are stored in <code>sparc-breast-dataset</code> and <code>sparc-heart-dataset</code>. Then we can based on the diagram to convert the data to FHIR ImagingStudy resources.</p><p><img src="/codespacex/fhir/01-fhir-resources/05-sparc-imagingstudy-dev.png" alt="sparc imagingstudy dev"></p><h2 id="setup-environment" tabindex="-1">Setup environment <a class="header-anchor" href="#setup-environment" aria-label="Permalink to &quot;Setup environment&quot;">​</a></h2><ul><li>Same to Tutorial 02</li></ul><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><h3 id="import-library" tabindex="-1">Import library <a class="header-anchor" href="#import-library" aria-label="Permalink to &quot;Import library&quot;">​</a></h3><p>At the beginning we need to import libraries <code>fhirpy</code> and <code>os</code>.</p><p>Also, we re-use the customise function <code>pprint</code> from Tutorial-02. We&#39;ll use it to display some Observation resource data structures.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> os</span></span>\n<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> fhirpy </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> AsyncFHIRClient</span></span>\n<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pathlib </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Path</span></span>\n<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> pydicom</span></span>\n<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> datetime </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> datetime</span></span>\n<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> uuid</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> os</span></span>\n<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> fhirpy </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> AsyncFHIRClient</span></span>\n<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pathlib </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Path</span></span>\n<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> pydicom</span></span>\n<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> datetime </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> datetime</span></span>\n<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> uuid</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="create-an-instance-of-connection" tabindex="-1">Create an instance of connection <a class="header-anchor" href="#create-an-instance-of-connection" aria-label="Permalink to &quot;Create an instance of connection&quot;">​</a></h3><p>To load data from FHIR server we should instaniate <code>FHIRClient</code> class from <code>fhirpy AsyncFHIRClient</code> method.</p><p>Let&#39;s pass <code>url</code> and <code>authorization</code> arguments from environment.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> AsyncFHIRClient(</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">url</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;http://localhost:8080/fhir/&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">authorization</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;Bearer TOKEN&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    )</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> AsyncFHIRClient(</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">url</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;http://localhost:8080/fhir/&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">authorization</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;Bearer TOKEN&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Now, we are able to operate with FHIR resources using <code>client</code>.</p><h2 id="read-and-perpare-sparc-sds-dataset-dicom-files-structure" tabindex="-1">Read and Perpare SPARC SDS dataset Dicom files structure <a class="header-anchor" href="#read-and-perpare-sparc-sds-dataset-dicom-files-structure" aria-label="Permalink to &quot;Read and Perpare SPARC SDS dataset Dicom files structure&quot;">​</a></h2><p>For easily to create a ImagingStudy resource, we can read the whole SPARC datasets structure into a dictionary. This is in order to use <code>pydicom</code> to read each dicom file header informations.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">sparc_fhir_structure </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}</span></span>\n<span class="line"><span style="color:#E1E4E8;">sparc_data_paths </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [Path(</span><span style="color:#9ECBFF;">&quot;./sparc_fhir_breast_dataset/primary/&quot;</span><span style="color:#E1E4E8;">), Path(</span><span style="color:#9ECBFF;">&quot;./sparc_fhir_heart_dataset/primary/&quot;</span><span style="color:#E1E4E8;">)]</span></span>\n<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> sparc_data_path </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> sparc_data_paths:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    sparc_fhir_structure[sparc_data_path.parent] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> study </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> sparc_data_path.iterdir():</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> study.is_dir():</span></span>\n<span class="line"><span style="color:#E1E4E8;">            sparc_fhir_structure[sparc_data_path.parent][study.name] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> series </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> study.iterdir():</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> series.is_dir():</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    sparc_fhir_structure[sparc_data_path.parent][study.name][series.name] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">list</span><span style="color:#E1E4E8;">(</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        series.glob(</span><span style="color:#9ECBFF;">&#39;*.dcm&#39;</span><span style="color:#E1E4E8;">))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">sparc_fhir_structure </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>\n<span class="line"><span style="color:#24292E;">sparc_data_paths </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [Path(</span><span style="color:#032F62;">&quot;./sparc_fhir_breast_dataset/primary/&quot;</span><span style="color:#24292E;">), Path(</span><span style="color:#032F62;">&quot;./sparc_fhir_heart_dataset/primary/&quot;</span><span style="color:#24292E;">)]</span></span>\n<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> sparc_data_path </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> sparc_data_paths:</span></span>\n<span class="line"><span style="color:#24292E;">    sparc_fhir_structure[sparc_data_path.parent] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> study </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> sparc_data_path.iterdir():</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> study.is_dir():</span></span>\n<span class="line"><span style="color:#24292E;">            sparc_fhir_structure[sparc_data_path.parent][study.name] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> series </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> study.iterdir():</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> series.is_dir():</span></span>\n<span class="line"><span style="color:#24292E;">                    sparc_fhir_structure[sparc_data_path.parent][study.name][series.name] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">list</span><span style="color:#24292E;">(</span></span>\n<span class="line"><span style="color:#24292E;">                        series.glob(</span><span style="color:#032F62;">&#39;*.dcm&#39;</span><span style="color:#24292E;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>As a result, the dictionary stucture should looks like below:</p><p><img src="/codespacex/fhir/01-fhir-resources/06-sparc-dict.png" alt="sparc imagingstudy dev"></p><h2 id="create-patients" tabindex="-1">Create Patients <a class="header-anchor" href="#create-patients" aria-label="Permalink to &quot;Create Patients&quot;">​</a></h2><p>Here, for this tutorial we can create two dummy patients for test. In a real development, we need to read the dicom header to find out the patient&#39;s information then based on that information to create the <code>Patient Resource</code>. As for the information tags you can read <a href="https://dicom.nema.org/medical/dicom/current/output/html/part06.html" target="_blank" rel="noreferrer">DICOM Part 6 Data Dictionary</a>, here provides some examples:</p><ul><li><code>(0010, 0010) Patient&#39;s Name</code></li><li><code>(0010, 0020) Patient ID</code></li><li><code>(0010, 0030) Patient&#39;s Birth Date</code></li><li><code>(0010, 0040) Patient&#39;s Sex</code></li><li><code>(0010, 1010) Patient&#39;s Age</code></li></ul><p>The Patient here is used for reference in ImagingStudy resource.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Aniyah </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span><span style="color:#9ECBFF;">&#39;Patient&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;given&#39;</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;Aniyah&#39;</span><span style="color:#E1E4E8;">],</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;family&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;use&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;official&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;prefix&#39;</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;Mr. &#39;</span><span style="color:#E1E4E8;">],</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            }</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        ],</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#FFAB70;">gender</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;female&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#FFAB70;">brithDate</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;1995-09-22&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        )</span></span>\n<span class="line"><span style="color:#E1E4E8;">Linman </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span><span style="color:#9ECBFF;">&#39;Patient&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;given&#39;</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;Linman&#39;</span><span style="color:#E1E4E8;">],</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;family&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;Zhang&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;use&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;official&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">&#39;prefix&#39;</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;Mr. &#39;</span><span style="color:#E1E4E8;">],</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            }</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        ],</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#FFAB70;">gender</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;female&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        </span><span style="color:#FFAB70;">brithDate</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;1993-08-15&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        )</span></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Aniyah.save()</span></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Linman.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Aniyah </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span><span style="color:#032F62;">&#39;Patient&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                        </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>\n<span class="line"><span style="color:#24292E;">                            {</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;given&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;Aniyah&#39;</span><span style="color:#24292E;">],</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;family&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;use&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;official&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;prefix&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;Mr. &#39;</span><span style="color:#24292E;">],</span></span>\n<span class="line"><span style="color:#24292E;">                            }</span></span>\n<span class="line"><span style="color:#24292E;">                        ],</span></span>\n<span class="line"><span style="color:#24292E;">                        </span><span style="color:#E36209;">gender</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;female&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                        </span><span style="color:#E36209;">brithDate</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;1995-09-22&#39;</span></span>\n<span class="line"><span style="color:#24292E;">                        )</span></span>\n<span class="line"><span style="color:#24292E;">Linman </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span><span style="color:#032F62;">&#39;Patient&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                        </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>\n<span class="line"><span style="color:#24292E;">                            {</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;given&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;Linman&#39;</span><span style="color:#24292E;">],</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;family&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;Zhang&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;use&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;official&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                                </span><span style="color:#032F62;">&#39;prefix&#39;</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;Mr. &#39;</span><span style="color:#24292E;">],</span></span>\n<span class="line"><span style="color:#24292E;">                            }</span></span>\n<span class="line"><span style="color:#24292E;">                        ],</span></span>\n<span class="line"><span style="color:#24292E;">                        </span><span style="color:#E36209;">gender</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;female&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                        </span><span style="color:#E36209;">brithDate</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;1993-08-15&#39;</span></span>\n<span class="line"><span style="color:#24292E;">                        )</span></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Aniyah.save()</span></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Linman.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="create-imagingstudy-resources" tabindex="-1">Create ImagingStudy Resources <a class="header-anchor" href="#create-imagingstudy-resources" aria-label="Permalink to &quot;Create ImagingStudy Resources&quot;">​</a></h2><p><a href="http://hl7.org/fhir/R4/imagingstudy.html" target="_blank" rel="noreferrer">ImagingStudy</a> resource provides mappings of its elements to DICOM attributes. DICOM attributes are identified by a 32-bit tag, presented in canonical form as two four-digit hexadecimal values within parentheses and separated by a comma, e.g. (0008, 103E). The name and value representation (data type) of each attribute can be found in <a href="http://medical.nema.org/medical/dicom/current/output/html/part06.html" target="_blank" rel="noreferrer">DICOM Part 6 Data Dictionary</a>. The use of the attributes in the context of information objects, including detailed description of use, can be found in <a href="http://medical.nema.org/medical/dicom/current/output/html/part03.html" target="_blank" rel="noreferrer">DICOM Part 3 Information Object Definitions</a>. Attributes used in the DICOM query information models, such as <code>Number of Instances in Study</code>, can be found in <a href="http://medical.nema.org/medical/dicom/current/output/html/part04.html#chapter_C" target="_blank" rel="noreferrer">DICOM Part 4 Annex</a>.</p><p>DICOM Series Instance UID and SOP Instance UID use the <code>id</code> datatype, and are encoded directly. For example, an image with SOP Instance UID of <code>2.16.124.113543.1154777499.30246.19789.3503430045.1.1</code> is encoded in <code>ImagingStudy.series.instance.uid</code> as <code>2.16.124.113543.1154777499.30246.19789.3503430045.1.1</code>.</p><p>The ImagingStudy&#39;s DICOM Study Instance UID is encoded in the <code>ImagingStudy.identifier</code> element, which is of the <code>Identifier</code> datatype. When encoding a DICOM UID in an <code>Identifier</code> datatype, use the Identifier system of <code>&quot;urn:dicom:uid&quot;</code>, and prefix the UID calue with <code>&quot;urn:oid:&quot;</code>. Therefore, an ImagingStudy with DICOM Study Instance UID of <code>2.16.124.113543.1154777499.30246.19789.3503430046</code> is encoded as:</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;identifier&quot;</span><span style="color:#E1E4E8;">: {</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;urn:dicom:uid&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;value&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;urn:oid:2.16.124.113543.1154777499.30246.19789.3503430046&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">  }</span></span>\n<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">&quot;identifier&quot;</span><span style="color:#24292E;">: {</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;urn:dicom:uid&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;value&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;urn:oid:2.16.124.113543.1154777499.30246.19789.3503430046&quot;</span></span>\n<span class="line"><span style="color:#24292E;">  }</span></span>\n<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Here are some useful dicom tags for building ImagingStudy Resource:</p><ul><li>(0020, 000d) Study Instance UID</li><li>(0020, 000e) Series Instance UID</li><li>(0008, 0018) SOP Instance UID</li><li>(0020, 0013) Instance Number</li><li>(0008, 0030) Study Time</li><li>(0020,1208) Number of Study Related Instances</li><li>(0020,1206) Number of Study Related Series</li><li>(0020,1209) Number of Series Related Instances</li><li>(0018, 0010) Contrast/Bolus Agent</li><li>(0018, 0015) Body Part Examined</li></ul><h3 id="let-s-create-a-imagingstudy-for-aniyah-s-breast-study" tabindex="-1">Let&#39;s create a ImagingStudy for Aniyah&#39;s breast study <a class="header-anchor" href="#let-s-create-a-imagingstudy-for-aniyah-s-breast-study" aria-label="Permalink to &quot;Let&#39;s create a ImagingStudy for Aniyah&#39;s breast study&quot;">​</a></h3><h4 id="get-the-study-samples-for-sparc-dictionary" tabindex="-1">Get the study/samples for SPARC dictionary <a class="header-anchor" href="#get-the-study-samples-for-sparc-dictionary" aria-label="Permalink to &quot;Get the study/samples for SPARC dictionary&quot;">​</a></h4><ul><li>Get study/samples</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Aniyah_breast_study </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sparc_fhir_structure[</span><span style="color:#9ECBFF;">&quot;sparc_fhir_breast_dataset&quot;</span><span style="color:#E1E4E8;">][</span><span style="color:#9ECBFF;">&quot;sub-Aniyah-breast-1&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Aniyah_breast_study </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sparc_fhir_structure[</span><span style="color:#032F62;">&quot;sparc_fhir_breast_dataset&quot;</span><span style="color:#24292E;">][</span><span style="color:#032F62;">&quot;sub-Aniyah-breast-1&quot;</span><span style="color:#24292E;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="using-pydicom-to-find-header-informations-for-imagingstudy" tabindex="-1">Using pydicom to find header informations for ImagingStudy <a class="header-anchor" href="#using-pydicom-to-find-header-informations-for-imagingstudy" aria-label="Permalink to &quot;Using pydicom to find header informations for ImagingStudy&quot;">​</a></h4><p>Using pydicom to read the a series/sample dicom file header tags, we can get the <code>Study Instance UID</code>, <code>Number of Study Related Instances</code>, <code> Number of Study Related Series</code>, <code>Study Time</code>.</p><p>Because of de-identification dicom data, some tags will missing. So we need use <code>try except</code> to catch the error.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">dicom_file </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pydicom.dcmread(Aniyah_breast_study[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">][</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">])</span></span>\n<span class="line"><span style="color:#E1E4E8;">study_uid </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0020</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">000d</span><span style="color:#E1E4E8;">)].value</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    dicom_study_time </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0008</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0030</span><span style="color:#E1E4E8;">)].value</span></span>\n<span class="line"><span style="color:#E1E4E8;">    started_time </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> datetime.strptime(dicom_study_time, </span><span style="color:#9ECBFF;">&quot;%H%M%S.</span><span style="color:#79B8FF;">%f</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">).strftime(</span><span style="color:#9ECBFF;">&quot;%Y-%m-</span><span style="color:#79B8FF;">%d</span><span style="color:#9ECBFF;">T%H:%M:%S&quot;</span><span style="color:#E1E4E8;">)</span></span>\n<span class="line"><span style="color:#F97583;">except</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    started_time </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> datetime.now().strftime(</span><span style="color:#9ECBFF;">&#39;%Y-%m-</span><span style="color:#79B8FF;">%d</span><span style="color:#9ECBFF;">T%H:%M:%S&#39;</span><span style="color:#E1E4E8;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    numberOfSeries </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">int</span><span style="color:#E1E4E8;">(dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0020</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">1206</span><span style="color:#E1E4E8;">)].value)</span></span>\n<span class="line"><span style="color:#F97583;">except</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    numberOfSeries </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(Aniyah_breast_study)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    numberOfInstances </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">int</span><span style="color:#E1E4E8;">(dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0020</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">1208</span><span style="color:#E1E4E8;">)].value)</span></span>\n<span class="line"><span style="color:#F97583;">except</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    numberOfInstances </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> sample </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> Aniyah_breast_study:</span></span>\n<span class="line"><span style="color:#E1E4E8;">        numberOfInstances </span><span style="color:#F97583;">+=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(sample)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">dicom_file </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pydicom.dcmread(Aniyah_breast_study[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">])</span></span>\n<span class="line"><span style="color:#24292E;">study_uid </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0020</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">000d</span><span style="color:#24292E;">)].value</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">    dicom_study_time </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0008</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0030</span><span style="color:#24292E;">)].value</span></span>\n<span class="line"><span style="color:#24292E;">    started_time </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> datetime.strptime(dicom_study_time, </span><span style="color:#032F62;">&quot;%H%M%S.</span><span style="color:#005CC5;">%f</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">).strftime(</span><span style="color:#032F62;">&quot;%Y-%m-</span><span style="color:#005CC5;">%d</span><span style="color:#032F62;">T%H:%M:%S&quot;</span><span style="color:#24292E;">)</span></span>\n<span class="line"><span style="color:#D73A49;">except</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">    started_time </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> datetime.now().strftime(</span><span style="color:#032F62;">&#39;%Y-%m-</span><span style="color:#005CC5;">%d</span><span style="color:#032F62;">T%H:%M:%S&#39;</span><span style="color:#24292E;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">    numberOfSeries </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">(dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0020</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">1206</span><span style="color:#24292E;">)].value)</span></span>\n<span class="line"><span style="color:#D73A49;">except</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">    numberOfSeries </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(Aniyah_breast_study)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">    numberOfInstances </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">(dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0020</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">1208</span><span style="color:#24292E;">)].value)</span></span>\n<span class="line"><span style="color:#D73A49;">except</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">    numberOfInstances </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> sample </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> Aniyah_breast_study:</span></span>\n<span class="line"><span style="color:#24292E;">        numberOfInstances </span><span style="color:#D73A49;">+=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(sample)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="create-series-and-instance-array-of-imagingstudy" tabindex="-1">Create Series and Instance Array of ImagingStudy <a class="header-anchor" href="#create-series-and-instance-array-of-imagingstudy" aria-label="Permalink to &quot;Create Series and Instance Array of ImagingStudy&quot;">​</a></h4><p>Because we have a sparc dictionary stucture, we can easily to use <code>for loop</code> to create the <code>Series and Instance Array</code>. In here we need to use <code>Series Instance UID</code>, <code>SOP Instance UID</code>, <code>Instance Number</code>, <code>Number of Series Related Instances</code> tags.</p><p>As for the <code>series modality code</code>, we can find it in <a href="http://dicom.nema.org/resources/ontology/DCM" target="_blank" rel="noreferrer">dicom website</a>.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;">series </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> []</span></span>\n<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> sample </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> Aniyah_breast_study:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    instances </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> []</span></span>\n<span class="line"><span style="color:#E1E4E8;">    sample_dicom_file </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pydicom.dcmread(sample[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">])</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">        numberOfSeriesInstances </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">int</span><span style="color:#E1E4E8;">(sample_dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0020</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">1209</span><span style="color:#E1E4E8;">)].value)</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">except</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">        numberOfSeriesInstances </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len</span><span style="color:#E1E4E8;">(sample)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> item </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> sample:</span></span>\n<span class="line"><span style="color:#E1E4E8;">        instance_dicom_file </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> pydicom.dcmread(item)</span></span>\n<span class="line"><span style="color:#E1E4E8;">        dicom_instance </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;uid&quot;</span><span style="color:#E1E4E8;">: instance_dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0008</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0018</span><span style="color:#E1E4E8;">)].value,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;number&quot;</span><span style="color:#E1E4E8;">: instance_dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0020</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0013</span><span style="color:#E1E4E8;">)].value,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }</span></span>\n<span class="line"><span style="color:#E1E4E8;">        instances.append(dicom_instance)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;">    series.append({</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;uid&quot;</span><span style="color:#E1E4E8;">: sample_dicom_file[(</span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">0020</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">0x</span><span style="color:#79B8FF;">000e</span><span style="color:#E1E4E8;">)].value,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;modality&quot;</span><span style="color:#E1E4E8;">: {</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;http://dicom.nema.org/resources/ontology/DCM&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;code&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;MR&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        },</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;numberOfInstances&quot;</span><span style="color:#E1E4E8;">: numberOfSeriesInstances,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;instance&quot;</span><span style="color:#E1E4E8;">: instances</span></span>\n<span class="line"><span style="color:#E1E4E8;">    })</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>\n<span class="line"><span style="color:#24292E;">series </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []</span></span>\n<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> sample </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> Aniyah_breast_study:</span></span>\n<span class="line"><span style="color:#24292E;">    instances </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []</span></span>\n<span class="line"><span style="color:#24292E;">    sample_dicom_file </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pydicom.dcmread(sample[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">])</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">        numberOfSeriesInstances </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">int</span><span style="color:#24292E;">(sample_dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0020</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">1209</span><span style="color:#24292E;">)].value)</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">except</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">        numberOfSeriesInstances </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len</span><span style="color:#24292E;">(sample)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> item </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> sample:</span></span>\n<span class="line"><span style="color:#24292E;">        instance_dicom_file </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> pydicom.dcmread(item)</span></span>\n<span class="line"><span style="color:#24292E;">        dicom_instance </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;uid&quot;</span><span style="color:#24292E;">: instance_dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0008</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0018</span><span style="color:#24292E;">)].value,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;number&quot;</span><span style="color:#24292E;">: instance_dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0020</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0013</span><span style="color:#24292E;">)].value,</span></span>\n<span class="line"><span style="color:#24292E;">        }</span></span>\n<span class="line"><span style="color:#24292E;">        instances.append(dicom_instance)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;">    series.append({</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;uid&quot;</span><span style="color:#24292E;">: sample_dicom_file[(</span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">0020</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">0x</span><span style="color:#005CC5;">000e</span><span style="color:#24292E;">)].value,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;modality&quot;</span><span style="color:#24292E;">: {</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;http://dicom.nema.org/resources/ontology/DCM&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;code&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;MR&quot;</span></span>\n<span class="line"><span style="color:#24292E;">        },</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;numberOfInstances&quot;</span><span style="color:#24292E;">: numberOfSeriesInstances,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;instance&quot;</span><span style="color:#24292E;">: instances</span></span>\n<span class="line"><span style="color:#24292E;">    })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h4 id="create-a-aniyah-s-breast-imagingstudy" tabindex="-1">Create a Aniyah&#39;s breast ImagingStudy <a class="header-anchor" href="#create-a-aniyah-s-breast-imagingstudy" aria-label="Permalink to &quot;Create a Aniyah&#39;s breast ImagingStudy&quot;">​</a></h4><p>As we discussed the <code>identifier</code> before, we need use <code>&quot;urn:dicom:uid&quot;</code> system to store the <code>study uid</code> as the identifier value. Here, we can create two customise identifier for easily mapping the SPARC SDS dataset and FHIR ImagingStudy resource structure. So we can create two local identifier for the SPARC SDS system: <code>urn:sparc_study:uid</code> and <code>urn:sparc_dataset:uid</code>.</p><ul><li><code>urn:sparc_study:uid</code>: is used to store the unique subject/study folder name in SPARC SDS dataset to ImagingStudy identifier.</li><li><code>urn:sparc_dataset:uid</code>: is used to store the unique sparc dataset name to ImagingStudy identifier.</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">imagingResource </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span><span style="color:#9ECBFF;">&#39;ImagingStudy&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">identifier</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;urn:dicom:uid&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;value&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;urn:oid:</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">study_uid</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        },</span></span>\n<span class="line"><span style="color:#E1E4E8;">            {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;use&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;temp&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;urn:sparc_study:uid&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;value&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;urn:uid:</span><span style="color:#79B8FF;">{</span><span style="color:#9ECBFF;">&quot;sub-Aniyah-breast-1&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;-&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> study_uid</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            },</span></span>\n<span class="line"><span style="color:#E1E4E8;">            {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;use&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;temp&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;urn:sparc_dataset:uid&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&quot;value&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;urn:uid:</span><span style="color:#79B8FF;">{</span><span style="color:#9ECBFF;">&quot;sparc_fhir_breast_dataset&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;-&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">(uuid.uuid4())</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            },</span></span>\n<span class="line"><span style="color:#E1E4E8;">        ],</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">status</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;available&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">subject</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">Aniyah.to_reference(),</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">started</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">started_time,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">numberOfSeries</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">numberOfSeries,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">numberOfInstances</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">numberOfInstances,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">series</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">series</span></span>\n<span class="line"><span style="color:#E1E4E8;">        )</span></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> imagingResource.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">imagingResource </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span><span style="color:#032F62;">&#39;ImagingStudy&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">identifier</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;urn:dicom:uid&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;value&quot;</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;urn:oid:</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">study_uid</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span></span>\n<span class="line"><span style="color:#24292E;">        },</span></span>\n<span class="line"><span style="color:#24292E;">            {</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;use&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;temp&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;urn:sparc_study:uid&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;value&quot;</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;urn:uid:</span><span style="color:#005CC5;">{</span><span style="color:#032F62;">&quot;sub-Aniyah-breast-1&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;-&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> study_uid</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span></span>\n<span class="line"><span style="color:#24292E;">            },</span></span>\n<span class="line"><span style="color:#24292E;">            {</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;use&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;temp&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;urn:sparc_dataset:uid&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&quot;value&quot;</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;urn:uid:</span><span style="color:#005CC5;">{</span><span style="color:#032F62;">&quot;sparc_fhir_breast_dataset&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;-&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">(uuid.uuid4())</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span></span>\n<span class="line"><span style="color:#24292E;">            },</span></span>\n<span class="line"><span style="color:#24292E;">        ],</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">status</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;available&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">subject</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">Aniyah.to_reference(),</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">started</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">started_time,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">numberOfSeries</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">numberOfSeries,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">numberOfInstances</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">numberOfInstances,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">series</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">series</span></span>\n<span class="line"><span style="color:#24292E;">        )</span></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> imagingResource.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="update-imagingstudy-resource" tabindex="-1">Update ImagingStudy Resource <a class="header-anchor" href="#update-imagingstudy-resource" aria-label="Permalink to &quot;Update ImagingStudy Resource&quot;">​</a></h2><p>Under creating ImagingStudy part, we forgot to create <code>bodySite</code> in each <code>series</code>. We can find the code in <a href="https://browser.ihtsdotools.org/?perspective=full&amp;conceptId1=76752008&amp;edition=MAIN/2023-10-01&amp;release=&amp;languages=en&amp;latestRedirect=false" target="_blank" rel="noreferrer">SNOMED CT</a>.</p><ul><li>BodySite: The anatomic structures examined. See <a href="http://dicom.nema.org/medical/dicom/current/output/chtml/part16/chapter_L.html" target="_blank" rel="noreferrer">DICOM Part 16 Annex L</a> for DICOM to SNOMED-CT mappings. The bodySite may indicate the laterality of body part imaged; if so, it shall be consistent with any content of <code>ImagingStudy.series.laterality</code>.</li></ul><p>The code for <code>breast</code> and <code>heart</code>:</p><ul><li><code>Breast</code>: <code>76752008</code></li><li><code>Heart</code>: <code>80891009</code></li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">imagingStudyResourceSearchSet </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;ImagingStudy&#39;</span><span style="color:#E1E4E8;">)</span></span>\n<span class="line"><span style="color:#E1E4E8;">count </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> imagingStudyResourceSearchSet.count()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># Get all imagingstudy resources</span></span>\n<span class="line"><span style="color:#E1E4E8;">imagingStudys </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> imagingStudyResourceSearchSet.limit(count).fetch()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># find a patient in which datasets</span></span>\n<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> imagingstudy </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> imagingStudys:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;identifier&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> imagingstudy:</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> identifier </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> imagingstudy[</span><span style="color:#9ECBFF;">&#39;identifier&#39;</span><span style="color:#E1E4E8;">]:</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> identifier.get(</span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;urn:sparc_dataset:uid&#39;</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> index, series </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">enumerate</span><span style="color:#E1E4E8;">(imagingstudy[</span><span style="color:#9ECBFF;">&quot;series&quot;</span><span style="color:#E1E4E8;">]):</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;breast&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> identifier.get(</span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">):</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        imagingstudy[</span><span style="color:#9ECBFF;">&quot;series&quot;</span><span style="color:#E1E4E8;">][index][</span><span style="color:#9ECBFF;">&quot;bodySite&quot;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;http://snomed.info/sct&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">&quot;code&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;76752008&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">&quot;display&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Breast&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        }</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">elif</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;heart&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> identifier.get(</span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">):</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        imagingstudy[</span><span style="color:#9ECBFF;">&quot;series&quot;</span><span style="color:#E1E4E8;">][index][</span><span style="color:#9ECBFF;">&quot;bodySite&quot;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;http://snomed.info/sct&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">&quot;code&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;80891009&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">&quot;display&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Heart&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                        }</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> imagingstudy.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">imagingStudyResourceSearchSet </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;ImagingStudy&#39;</span><span style="color:#24292E;">)</span></span>\n<span class="line"><span style="color:#24292E;">count </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> imagingStudyResourceSearchSet.count()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># Get all imagingstudy resources</span></span>\n<span class="line"><span style="color:#24292E;">imagingStudys </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> imagingStudyResourceSearchSet.limit(count).fetch()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># find a patient in which datasets</span></span>\n<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> imagingstudy </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> imagingStudys:</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;identifier&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> imagingstudy:</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> identifier </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> imagingstudy[</span><span style="color:#032F62;">&#39;identifier&#39;</span><span style="color:#24292E;">]:</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> identifier.get(</span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;urn:sparc_dataset:uid&#39;</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> index, series </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">enumerate</span><span style="color:#24292E;">(imagingstudy[</span><span style="color:#032F62;">&quot;series&quot;</span><span style="color:#24292E;">]):</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;breast&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> identifier.get(</span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">):</span></span>\n<span class="line"><span style="color:#24292E;">                        imagingstudy[</span><span style="color:#032F62;">&quot;series&quot;</span><span style="color:#24292E;">][index][</span><span style="color:#032F62;">&quot;bodySite&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>\n<span class="line"><span style="color:#24292E;">                            </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;http://snomed.info/sct&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                            </span><span style="color:#032F62;">&quot;code&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;76752008&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                            </span><span style="color:#032F62;">&quot;display&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Breast&quot;</span></span>\n<span class="line"><span style="color:#24292E;">                        }</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">elif</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;heart&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> identifier.get(</span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">):</span></span>\n<span class="line"><span style="color:#24292E;">                        imagingstudy[</span><span style="color:#032F62;">&quot;series&quot;</span><span style="color:#24292E;">][index][</span><span style="color:#032F62;">&quot;bodySite&quot;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>\n<span class="line"><span style="color:#24292E;">                            </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;http://snomed.info/sct&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                            </span><span style="color:#032F62;">&quot;code&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;80891009&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                            </span><span style="color:#032F62;">&quot;display&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Heart&quot;</span></span>\n<span class="line"><span style="color:#24292E;">                        }</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> imagingstudy.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="search-imagingstudy-resource" tabindex="-1">Search ImagingStudy Resource <a class="header-anchor" href="#search-imagingstudy-resource" aria-label="Permalink to &quot;Search ImagingStudy Resource&quot;">​</a></h2><p>Please view <a href="http://hl7.org/fhir/R4/imagingstudy.html#search" target="_blank" rel="noreferrer">ImagingStudy Search Parameters</a> to find out the parameters for search in you senario.</p><ul><li>Let&#39;s try search all studies/ImagingStudy Resources of a patient/volunteer <code>Aniyah</code> accross all SPARC Datasets. (Find all ImagingStudy Resources related to <code>Aniyah</code>)</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">patientsResourceSearchSet </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&quot;Patient&quot;</span><span style="color:#E1E4E8;">)</span></span>\n<span class="line"><span style="color:#E1E4E8;">Aniyah </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> patientsResourceSearchSet.search(</span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&#39;Aniyah&#39;</span><span style="color:#E1E4E8;">]).first()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># find all studies of a patient cross all datasets</span></span>\n<span class="line"><span style="color:#E1E4E8;">imagingStudyResourceSearchSet </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;ImagingStudy&#39;</span><span style="color:#E1E4E8;">)</span></span>\n<span class="line"><span style="color:#E1E4E8;">imagingStudys </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> imagingStudyResourceSearchSet.search(</span><span style="color:#FFAB70;">patient</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">Aniyah.to_reference()).fetch_all()</span></span>\n<span class="line"><span style="color:#E1E4E8;">pprint(imagingStudys)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">patientsResourceSearchSet </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&quot;Patient&quot;</span><span style="color:#24292E;">)</span></span>\n<span class="line"><span style="color:#24292E;">Aniyah </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> patientsResourceSearchSet.search(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&#39;Aniyah&#39;</span><span style="color:#24292E;">]).first()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># find all studies of a patient cross all datasets</span></span>\n<span class="line"><span style="color:#24292E;">imagingStudyResourceSearchSet </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;ImagingStudy&#39;</span><span style="color:#24292E;">)</span></span>\n<span class="line"><span style="color:#24292E;">imagingStudys </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> imagingStudyResourceSearchSet.search(</span><span style="color:#E36209;">patient</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">Aniyah.to_reference()).fetch_all()</span></span>\n<span class="line"><span style="color:#24292E;">pprint(imagingStudys)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>Find <code>Aniyah&#39;s</code> ImagingStudy Resources in which SPARC SDS dataset</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># find a patient in which datasets</span></span>\n<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> imagingstudy </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> imagingStudys:</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> identifier </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> imagingstudy[</span><span style="color:#9ECBFF;">&#39;identifier&#39;</span><span style="color:#E1E4E8;">]:</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> identifier.get(</span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">==</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;urn:sparc_dataset:uid&#39;</span><span style="color:#E1E4E8;">:</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(identifier.get(</span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#6A737D;"># find a patient in which datasets</span></span>\n<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> imagingstudy </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> imagingStudys:</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> identifier </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> imagingstudy[</span><span style="color:#032F62;">&#39;identifier&#39;</span><span style="color:#24292E;">]:</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> identifier.get(</span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;urn:sparc_dataset:uid&#39;</span><span style="color:#24292E;">:</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(identifier.get(</span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>Find all <code>Breast</code> ImagingStudy resources via <code>bodysite</code>.</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># find all breast ImagingStudy resources</span></span>\n<span class="line"><span style="color:#E1E4E8;">imagingstudys </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;ImagingStudy&#39;</span><span style="color:#E1E4E8;">).search(</span><span style="color:#FFAB70;">bodysite</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;76752008&quot;</span><span style="color:#E1E4E8;">).fetch_all()</span></span>\n<span class="line"><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(imagingstudys)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># find all breast ImagingStudy resources</span></span>\n<span class="line"><span style="color:#24292E;">imagingstudys </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;ImagingStudy&#39;</span><span style="color:#24292E;">).search(</span><span style="color:#E36209;">bodysite</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;76752008&quot;</span><span style="color:#24292E;">).fetch_all()</span></span>\n<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(imagingstudys)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>Find all <code>Heart</code> ImagingStudy resources via <code>bodysite</code>.</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># find all heart ImagingStudy resources</span></span>\n<span class="line"><span style="color:#E1E4E8;">imagingstudys </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;ImagingStudy&#39;</span><span style="color:#E1E4E8;">).search(</span><span style="color:#FFAB70;">bodysite</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;80891009&quot;</span><span style="color:#E1E4E8;">).fetch_all()</span></span>\n<span class="line"><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(imagingstudys)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># find all heart ImagingStudy resources</span></span>\n<span class="line"><span style="color:#24292E;">imagingstudys </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;ImagingStudy&#39;</span><span style="color:#24292E;">).search(</span><span style="color:#E36209;">bodysite</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;80891009&quot;</span><span style="color:#24292E;">).fetch_all()</span></span>\n<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(imagingstudys)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>Find a specific ImagingStudy resource if you have its identifier value</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">specific_ImagingStudy </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> imagingStudyResourceSearchSet.search(</span><span style="color:#FFAB70;">identifier</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;urn:uid:sparc_fhir_heart_dataset-9c3319e9-38f0-42fc-9b41-28a1be44f72e&#39;</span><span style="color:#E1E4E8;">).fetch()</span></span>\n<span class="line"><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(specific_ImagingStudy)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">specific_ImagingStudy </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> imagingStudyResourceSearchSet.search(</span><span style="color:#E36209;">identifier</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;urn:uid:sparc_fhir_heart_dataset-9c3319e9-38f0-42fc-9b41-28a1be44f72e&#39;</span><span style="color:#24292E;">).fetch()</span></span>\n<span class="line"><span style="color:#005CC5;">print</span><span style="color:#24292E;">(specific_ImagingStudy)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p>In this tutorial the following topics were covered:</p><ul><li><code>ImagingStudy</code> resources.</li><li>SPARC SDS dataset and ImagingStudy Resource relationship.</li><li>How to use <code>pydicom</code> to get dicom file tags information.</li><li>How to create a ImagingStudy Resource.</li><li>How to update a ImagingStudy Resource.</li><li>How to search <code>ImagingStudy Resource</code> for specific identifier and speciality.</li></ul>',75)];const t=s(e,[["render",function(s,l,p,e,t,r){return a(),n("div",null,o)}]]);export{p as __pageData,t as default};
