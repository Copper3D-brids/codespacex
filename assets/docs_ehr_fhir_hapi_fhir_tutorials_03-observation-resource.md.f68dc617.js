import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.f9076d03.js";const e=JSON.parse('{"title":"Tutorial - FHIR Observation Resource","description":"","frontmatter":{},"headers":[],"relativePath":"docs/ehr/fhir/hapi_fhir/tutorials/03-observation-resource.md","filePath":"docs/ehr/fhir/hapi_fhir/tutorials/03-observation-resource.md","lastUpdated":1697780928000}'),p={name:"docs/ehr/fhir/hapi_fhir/tutorials/03-observation-resource.md"},o=[l('<h1 id="tutorial-fhir-observation-resource" tabindex="-1">Tutorial - FHIR Observation Resource <a class="header-anchor" href="#tutorial-fhir-observation-resource" aria-label="Permalink to &quot;Tutorial - FHIR Observation Resource&quot;">​</a></h1><ul><li><p>Tutorial code on GitHub <a href="https://github.com/Copper3D-brids/hapi-py-fhir-tutorials/blob/main/observationOperator.py" target="_blank" rel="noreferrer">hapi-py-fhir-tutorials -- observationOpeartor.py</a>.</p></li><li><p>Currently, it is a <strong>private</strong> repository, will open source later...</p></li></ul><h2 id="background" tabindex="-1">Background <a class="header-anchor" href="#background" aria-label="Permalink to &quot;Background&quot;">​</a></h2><p>A Observation Resources are used to store basic physical information about the patient.</p><ul><li><code>Vital signs</code>: body weight, blood pressure, and temperature etc.</li><li><code>Laboratory Data</code>: blood glucose, or an estimated GFR etc.</li><li><code>Imaging Results</code>: bone density or fetal measurements etc.</li><li><code>Clinical Findings</code>: abdominal tenderness etc.</li><li><code>Device measurements</code>: EKG data or Pulse Oximetry data etc.</li><li><code>Device Settings</code>: mechanical ventilator parameters etc.</li><li><code>Clinical assessment tools</code>: APGAR or a Glasgow Coma Score etc.</li><li><code>Personal characteristics</code>: eye-color etc.</li><li><code>Social history</code>: tobacco use, family support, or cognitive status etc.</li><li><code>Core characteristics</code>: pregnancy status, or a death assertion.</li><li><code>Product quality tests</code>: pH, Assay, Microbial limits, etc. on product and substance.</li></ul><h3 id="scenario" tabindex="-1">Scenario <a class="header-anchor" href="#scenario" aria-label="Permalink to &quot;Scenario&quot;">​</a></h3><p>A clinical coordinator asked John about his complaints to clarify how we can help. John explained, he doesn&#39;t feel well this week. It&#39;s related to the temperature and high blood pressure. This started to happen on Monday (10-20-2022).</p><h2 id="setup-environment" tabindex="-1">Setup environment <a class="header-anchor" href="#setup-environment" aria-label="Permalink to &quot;Setup environment&quot;">​</a></h2><ul><li>Same to Tutorial 02</li></ul><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><h3 id="import-library" tabindex="-1">Import library <a class="header-anchor" href="#import-library" aria-label="Permalink to &quot;Import library&quot;">​</a></h3><p>At the beginning we need to import libraries <code>fhirpy</code> and <code>os</code>.</p><p>Also, we re-use the customise function <code>pprint</code> from Tutorial-02. We&#39;ll use it to display some Observation resource data structures.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> os</span></span>\n<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> fhirpy </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> AsyncFHIRClient</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> os</span></span>\n<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> fhirpy </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> AsyncFHIRClient</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="create-an-instance-of-connection" tabindex="-1">Create an instance of connection <a class="header-anchor" href="#create-an-instance-of-connection" aria-label="Permalink to &quot;Create an instance of connection&quot;">​</a></h3><p>To load data from FHIR server we should instaniate <code>FHIRClient</code> class from <code>fhirpy AsyncFHIRClient</code> method.</p><p>Let&#39;s pass <code>url</code> and <code>authorization</code> arguments from environment.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">client </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> AsyncFHIRClient(</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">url</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;http://localhost:8080/fhir/&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">authorization</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;Bearer TOKEN&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    )</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">client </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> AsyncFHIRClient(</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">url</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;http://localhost:8080/fhir/&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">authorization</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;Bearer TOKEN&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    )</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Now, we are able to operate with FHIR resources using <code>client</code>.</p><h2 id="load-data-from-the-fhir-server" tabindex="-1">Load data from the FHIR server <a class="header-anchor" href="#load-data-from-the-fhir-server" aria-label="Permalink to &quot;Load data from the FHIR server&quot;">​</a></h2><h3 id="load-list-of-observations" tabindex="-1">Load list of observations <a class="header-anchor" href="#load-list-of-observations" aria-label="Permalink to &quot;Load list of observations&quot;">​</a></h3><p><a href="http://hl7.org/fhir/R4/observation.html" target="_blank" rel="noreferrer">Observation</a> is a central element in healthcare, used to support a diagnosis, monitor progress, determine baselines and patterns and even capture demographic characteristics. Most observations are simple name/value pair assertions with some metadata, but some observations group other observations together logically, or even are multi-component observations.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">observations </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">).limit().fetch()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">observations </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">).limit().fetch()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>This line fetched a portion of data in size of from the server. You can see the result of its execution.</p><p>We also can display all data from the Observation</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">pprint(observations[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">])</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">pprint(observations[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="create-observation-record" tabindex="-1">Create Observation record <a class="header-anchor" href="#create-observation-record" aria-label="Permalink to &quot;Create Observation record&quot;">​</a></h2><p>There are two patient&#39;s claims:</p><ul><li>On Monday his temperature was 96.8 F and the blood pressure was 140/90.</li><li>On Tuesday his temperature was 100.4 F and the blood pressure was 120/80.</li></ul><p>The category of our claims is defined by the <code>category</code> field of the <code>Observation</code>. This field is of type <a href="https://www.hl7.org/fhir/datatypes.html#CodeableConcept" target="_blank" rel="noreferrer">CodeableConcept</a>.</p><p><code>CodeableConcept</code> consists of a terminology (<code>coding</code> field of type <a href="https://www.hl7.org/fhir/datatypes.html#Coding" target="_blank" rel="noreferrer">Coding</a>). We are going to use it in our formal description and a plain text problem explanation (<code>text</code> field of type <a href="https://www.hl7.org/fhir/datatypes.html#string" target="_blank" rel="noreferrer">string</a>). When none of the <code>coding</code> elements are marked as <code>userSelected</code>, the <code>text</code> (if present) it the preferred source of meaning.</p><p>Within <a href="https://www.hl7.org/fhir/datatypes.html#Coding" target="_blank" rel="noreferrer">Coding</a> we can refer to a particular <code>system</code> and <code>code</code>.</p><p><code>Observation</code> defines its <code>category.coding</code> in terms of <a href="https://www.hl7.org/fhir/valueset-observation-category.html" target="_blank" rel="noreferrer">observation-category</a>, so this is our <code>category.coding.system</code>.</p><p><code>observation-category</code> contains multiple concepts, yan can read up on them in the official FHIR specification.</p><p>Patient&#39;s claims contain information about the body temperature and the blood pressure, se we choose <code>vital-signs</code> as the <code>category.coding.code</code>.</p><p>From <a href="https://www.hl7.org/fhir/vitalsigns.html" target="_blank" rel="noreferrer">vital-signs structure definition</a> we can verify our <code>category</code> value (that we&#39;ve figured out above) and find out what the <code>code</code> value is.</p><p><code>Observation.code</code>:</p><ul><li><code>coding.system</code> - <a href="http://loinc.org" target="_blank" rel="noreferrer">http://loinc.org</a></li><li><code>coding.code</code> - one of the allowed <a href="https://www.hl7.org/fhir/valueset-observation-vitalsignresult.html" target="_blank" rel="noreferrer">vital sign result types</a>, in our case it is <code>8310-5</code> for body temperature, <code>8480-6</code> for systolic blood pressure and <code>8462-4</code> for diastolic blood pressure.</li></ul><p>Now we clarified <code>Observation category</code> and <code>code</code>. Let&#39;s create an <code>Observation</code> object.</p><p>Before we do that, please read a small note about Observation <a href="https://www.hl7.org/fhir/valueset-observation-status.html" target="_blank" rel="noreferrer">status</a> field: it is used to specify what the current status of an observation is.</p><p>There are multiple values defined in the <code>FHIR specification</code>, some of them are:</p><ul><li><code>registered</code> - The existence of the observation is registered, but there is no result yet available.</li><li><code>preliminary</code> - This is an initial or interim observation: data may be incomplete or unverified.</li><li><code>final</code> - The observation is complete.</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">observation </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">status</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;preliminary&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">category</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">: [{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">    }],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">code</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;8310-5&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">    }</span></span>\n<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">observation </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">status</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;preliminary&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">category</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">: [{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#24292E;">        }]</span></span>\n<span class="line"><span style="color:#24292E;">    }],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">code</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;8310-5&#39;</span></span>\n<span class="line"><span style="color:#24292E;">        }]</span></span>\n<span class="line"><span style="color:#24292E;">    }</span></span>\n<span class="line"><span style="color:#24292E;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><code>Observation</code> has a field called <code>valueQuantity</code> (of type Quantity) it contains current results of measurements performed.</p><p>According to <a href="https://www.hl7.org/fhir/vitalsigns.html" target="_blank" rel="noreferrer">vital-signs structure definition</a> for <code>vital-signs</code> category this field can be populated with (remember, it is of <a href="https://www.hl7.org/fhir/datatypes.html#Quantity" target="_blank" rel="noreferrer">Quantity</a> type):</p><ul><li><code>system</code> - <code>http://unitsofmeasure.org</code></li><li><code>value</code> - represents one numeric value</li><li><code>code</code> - UCUM (stands for The Unified Code for Units of Measure) unit code from <a href="https://www.hl7.org/fhir/valueset-ucum-vitals-common.html" target="_blank" rel="noreferrer">Vital Signs Units</a></li></ul><p>So, on Monday (10-20-2022) our patient has a temperature of <code>96.8F</code> let&#39;s write it in the observation</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">observation[</span><span style="color:#9ECBFF;">&#39;effectiveDateTime&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;2022-10-20&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;">observation[</span><span style="color:#9ECBFF;">&#39;valueQuantity&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">96.8</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;degF&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">observation[</span><span style="color:#032F62;">&#39;effectiveDateTime&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;2022-10-20&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;">observation[</span><span style="color:#032F62;">&#39;valueQuantity&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">96.8</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;degF&#39;</span></span>\n<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>We&#39;ve just created our first <code>Observation</code> object. Let&#39;s connect the <code>Observation</code>resource to the <code>Patient</code> resource from T-02 before saving to the HAPI FHIR server database.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">patient </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;Patient&#39;</span><span style="color:#E1E4E8;">).search(</span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&#39;John&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;Thompson&#39;</span><span style="color:#E1E4E8;">]).first()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">patient </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;Patient&#39;</span><span style="color:#24292E;">).search(</span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&#39;John&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;Thompson&#39;</span><span style="color:#24292E;">]).first()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>Patient</code> reference is stored in <code>Observation.subject</code>.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">observation[</span><span style="color:#9ECBFF;">&#39;subject&#39;</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> patient.to_reference()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> observation.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">observation[</span><span style="color:#032F62;">&#39;subject&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> patient.to_reference()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> observation.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Let&#39;s figure out what the current observation state is:</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">pprint(observation)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">pprint(observation)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="updated-scenario" tabindex="-1">Updated Scenario <a class="header-anchor" href="#updated-scenario" aria-label="Permalink to &quot;Updated Scenario&quot;">​</a></h3><p>Now the patient weight is 85 kilograms, we can add it into a new observation based <a href="https://www.hl7.org/fhir/vitalsigns.html" target="_blank" rel="noreferrer">vital-signs structure definition</a>, <a href="https://www.hl7.org/fhir/valueset-observation-vitalsignresult.html" target="_blank" rel="noreferrer">allowed vital sign result types</a> and <a href="https://www.hl7.org/fhir/valueset-ucum-vitals-common.html" target="_blank" rel="noreferrer">vital signs units</a>.</p><p>Also, let&#39;s go through the <a href="http://hl7.org/fhir/observation-examples.html#10.1.8.13" target="_blank" rel="noreferrer">observation example details</a> to find out a sulotion on how to fill the key/values pairs in a observation resource. This is an <a href="http://hl7.org/fhir/observation-example.json.html" target="_blank" rel="noreferrer">example for patient body weight</a> observation resource.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">weight_observation </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">status</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;preliminary&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">category</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">: [{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;vital-signs&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;display&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Vital Signs&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">    }],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">code</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;coding&quot;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;http://loinc.org&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;code&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;29463-7&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&quot;display&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Body Weight&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">    },</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">effectiveDateTime</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;2022-10-20&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">valueQuantity</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;value&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">85</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;unit&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;kg&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;system&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;\thttp://unitsofmeasure.org&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;code&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;kg&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">    },</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">subject</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">patient.to_reference()</span></span>\n<span class="line"><span style="color:#E1E4E8;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;">pprint(weight_observation)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> weight_observation.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">weight_observation </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">status</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;preliminary&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">category</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">: [{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;vital-signs&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;display&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Vital Signs&quot;</span></span>\n<span class="line"><span style="color:#24292E;">        }]</span></span>\n<span class="line"><span style="color:#24292E;">    }],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">code</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;coding&quot;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;http://loinc.org&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;code&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;29463-7&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&quot;display&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Body Weight&quot;</span></span>\n<span class="line"><span style="color:#24292E;">        }]</span></span>\n<span class="line"><span style="color:#24292E;">    },</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">effectiveDateTime</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;2022-10-20&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">valueQuantity</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;value&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">85</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;unit&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;kg&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;system&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;\thttp://unitsofmeasure.org&quot;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;code&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;kg&quot;</span></span>\n<span class="line"><span style="color:#24292E;">    },</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">subject</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">patient.to_reference()</span></span>\n<span class="line"><span style="color:#24292E;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;">pprint(weight_observation)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> weight_observation.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>Then let&#39;s create <code>Observation</code> object for the blood pressure.</p><p>Blood pressure value is built up of two parts: <code>systolic</code> and <code>diastolic</code>, and we have to specidy both of them in the same <code>Observation</code>. For this purpose there is a special field in Observation object called <code>component</code>. Each <code>component</code> field consists of <code>code</code> and <code>valueQuantity</code>. For <code>Observation</code> with multiple components we have to specify section header code. For blood pressure this code is <code>55284-4</code> from <code>http://lo*inc.org</code> system.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">blood_pressure_observation </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">status</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;preliminary&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">category</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]   </span></span>\n<span class="line"><span style="color:#E1E4E8;">    }],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">code</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;55284-4&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">        },</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">component</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span></span>\n<span class="line"><span style="color:#E1E4E8;">        {</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">:{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;8480-6&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">            },</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;valueQuantity&#39;</span><span style="color:#E1E4E8;">: {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">140</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            }</span></span>\n<span class="line"><span style="color:#E1E4E8;">        },</span></span>\n<span class="line"><span style="color:#E1E4E8;">        {</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">:{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;8462-4&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">            },</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;valueQuantity&#39;</span><span style="color:#E1E4E8;">:{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">90</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            }</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }</span></span>\n<span class="line"><span style="color:#E1E4E8;">    ],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">effectiveDateTime</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;2022-10-20&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">subject</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">patient.to_reference()</span></span>\n<span class="line"><span style="color:#E1E4E8;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;">pprint(blood_pressure_observation)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> blood_pressure_observation.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">blood_pressure_observation </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">status</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;preliminary&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">category</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#24292E;">        }]   </span></span>\n<span class="line"><span style="color:#24292E;">    }],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">code</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;55284-4&#39;</span></span>\n<span class="line"><span style="color:#24292E;">            }]</span></span>\n<span class="line"><span style="color:#24292E;">        },</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">component</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>\n<span class="line"><span style="color:#24292E;">        {</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">:{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;8480-6&#39;</span></span>\n<span class="line"><span style="color:#24292E;">                }]</span></span>\n<span class="line"><span style="color:#24292E;">            },</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;valueQuantity&#39;</span><span style="color:#24292E;">: {</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">140</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#24292E;">            }</span></span>\n<span class="line"><span style="color:#24292E;">        },</span></span>\n<span class="line"><span style="color:#24292E;">        {</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">:{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;8462-4&#39;</span></span>\n<span class="line"><span style="color:#24292E;">                }]</span></span>\n<span class="line"><span style="color:#24292E;">            },</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;valueQuantity&#39;</span><span style="color:#24292E;">:{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">90</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#24292E;">            }</span></span>\n<span class="line"><span style="color:#24292E;">        }</span></span>\n<span class="line"><span style="color:#24292E;">    ],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">effectiveDateTime</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;2022-10-20&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">subject</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">patient.to_reference()</span></span>\n<span class="line"><span style="color:#24292E;">)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;">pprint(blood_pressure_observation)</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> blood_pressure_observation.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h3 id="create-observation-for-each-data" tabindex="-1">Create observation for each data <a class="header-anchor" href="#create-observation-for-each-data" aria-label="Permalink to &quot;Create observation for each data&quot;">​</a></h3><p><strong>Note:</strong> The observation resource is used for store one type of category data. If we have multiple temperature, blood pressure .etc data, we need to create separate observation resource for each of them. Even if they have same data on blood pressure but on different dates, we also need to create observation resources for each of them, and link them to a same <code>Patient</code> resource reference.</p><p>Thus, let&#39;s create observations for Tuesday values of blood pressure and the body temperature using scenarios give above.</p><ul><li>Temperature</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">tuesday_temperature_observation </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">status</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;preliminary&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">category</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">: [{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">    }],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">code</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">: [{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;8310-5&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">    },</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">effectiveDateTime</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;2022-10-21&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">valueQuantity</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">100.4</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;degF&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">    }</span></span>\n<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">tuesday_temperature_observation </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">status</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;preliminary&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">category</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">: [{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#24292E;">        }]</span></span>\n<span class="line"><span style="color:#24292E;">    }],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">code</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">: [{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;8310-5&#39;</span></span>\n<span class="line"><span style="color:#24292E;">        }]</span></span>\n<span class="line"><span style="color:#24292E;">    },</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">effectiveDateTime</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;2022-10-21&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">valueQuantity</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">100.4</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;degF&#39;</span></span>\n<span class="line"><span style="color:#24292E;">    }</span></span>\n<span class="line"><span style="color:#24292E;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li>Blood pressure</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">tuesday_blood_pressure_observaion </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> client.resource(</span></span>\n<span class="line"><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">status</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;preliminary&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">category</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }]   </span></span>\n<span class="line"><span style="color:#E1E4E8;">    }],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">code</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;55284-4&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">        },</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">component</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span></span>\n<span class="line"><span style="color:#E1E4E8;">        {</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">:{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">:</span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;8480-6&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">            },</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;valueQuantity&#39;</span><span style="color:#E1E4E8;">: {</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">120</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            }</span></span>\n<span class="line"><span style="color:#E1E4E8;">        },</span></span>\n<span class="line"><span style="color:#E1E4E8;">        {</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">:{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;coding&#39;</span><span style="color:#E1E4E8;">:[{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://loinc.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;8462-4&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">                }]</span></span>\n<span class="line"><span style="color:#E1E4E8;">            },</span></span>\n<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">&#39;valueQuantity&#39;</span><span style="color:#E1E4E8;">:{</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;system&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;value&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">&#39;code&#39;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#E1E4E8;">            }</span></span>\n<span class="line"><span style="color:#E1E4E8;">        }</span></span>\n<span class="line"><span style="color:#E1E4E8;">    ],</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">effectiveDateTime</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;2022-10-21&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">subject</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">patient.to_reference()</span></span>\n<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">tuesday_blood_pressure_observaion </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> client.resource(</span></span>\n<span class="line"><span style="color:#24292E;">     </span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">status</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;preliminary&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">category</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[{</span></span>\n<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://hl7.org/fhir/observation-category&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;vital-signs&#39;</span></span>\n<span class="line"><span style="color:#24292E;">        }]   </span></span>\n<span class="line"><span style="color:#24292E;">    }],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">code</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;55284-4&#39;</span></span>\n<span class="line"><span style="color:#24292E;">            }]</span></span>\n<span class="line"><span style="color:#24292E;">        },</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">component</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>\n<span class="line"><span style="color:#24292E;">        {</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">:{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">:</span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;8480-6&#39;</span></span>\n<span class="line"><span style="color:#24292E;">                }]</span></span>\n<span class="line"><span style="color:#24292E;">            },</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;valueQuantity&#39;</span><span style="color:#24292E;">: {</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">120</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#24292E;">            }</span></span>\n<span class="line"><span style="color:#24292E;">        },</span></span>\n<span class="line"><span style="color:#24292E;">        {</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">:{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;coding&#39;</span><span style="color:#24292E;">:[{</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://loinc.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                    </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;8462-4&#39;</span></span>\n<span class="line"><span style="color:#24292E;">                }]</span></span>\n<span class="line"><span style="color:#24292E;">            },</span></span>\n<span class="line"><span style="color:#24292E;">            </span><span style="color:#032F62;">&#39;valueQuantity&#39;</span><span style="color:#24292E;">:{</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;system&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://unitsofmeasure.org&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;value&#39;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">80</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">                </span><span style="color:#032F62;">&#39;code&#39;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;mmHg&#39;</span></span>\n<span class="line"><span style="color:#24292E;">            }</span></span>\n<span class="line"><span style="color:#24292E;">        }</span></span>\n<span class="line"><span style="color:#24292E;">    ],</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">effectiveDateTime</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;2022-10-21&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">subject</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">patient.to_reference()</span></span>\n<span class="line"><span style="color:#24292E;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><ul><li>Save Tuesday&#39;s <code>Observation</code> resources to the HAPI FHIR server database</li></ul><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">tuesday_temperature_observation.save()</span></span>\n<span class="line"><span style="color:#E1E4E8;">tuesday_blood_pressure_observaion.save()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">tuesday_temperature_observation.save()</span></span>\n<span class="line"><span style="color:#24292E;">tuesday_blood_pressure_observaion.save()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="work-with-related-resources" tabindex="-1">Work with related resources <a class="header-anchor" href="#work-with-related-resources" aria-label="Permalink to &quot;Work with related resources&quot;">​</a></h2><p>We&#39;ve just created our first two observations. Let&#39;s see how to make a search. We can use <code>patient</code> search parameter to find all the patient&#39;s observations. There are multiple <a href="https://www.hl7.org/fhir/observation.html#search" target="_blank" rel="noreferrer">search parameters</a> defined for Observation. With <code>patient</code> we can search for observations which belong to the patient we&#39;ve created before by giving patient&#39;s <code>id</code> as an argument, or use <code>patient.to_reference()</code> to get the <code>id</code>.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">).search(</span><span style="color:#FFAB70;">patient</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">patient[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">]).fetch_all()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># or</span></span>\n<span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">).search(</span><span style="color:#FFAB70;">patient</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">patient.to_reference()).fetch_all()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">).search(</span><span style="color:#E36209;">patient</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">patient[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">]).fetch_all()</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#6A737D;"># or</span></span>\n<span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">).search(</span><span style="color:#E36209;">patient</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">patient.to_reference()).fetch_all()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>As you can see, there are multiple observations registered for the patient.</p><p>To do the reverse search for <code>Patient</code> based on a reference in <code>Observation</code> we can use <a href="https://www.hl7.org/fhir/search.html#has" target="_blank" rel="noreferrer">reverse chaining</a> with <code>_has</code> search parameter. <code>_has</code> allows to select resources based on the properties of resources which refer to them.</p><p>For example, query <code>GET /Patient?_has:Observation:patient:code=8310-5</code> will search for observayions with <code>code=8310-5</code> (which is related to the body temperature).</p><p>From every observation found retrieves a refernce to the <code>Patient</code> this observation refers to. The Patient is then included into the search result. Note that <code>code</code> here is not directly applies to <code>Observation</code> structure, it is defined as a <a href="https://www.hl7.org/fhir/observation.html#search" target="_blank" rel="noreferrer">search parameter</a> instead.</p><p>Let&#39;s build the same query with <code>fhirpy</code> API.</p><div class="language-py vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> client.resources(</span><span style="color:#9ECBFF;">&#39;Patient&#39;</span><span style="color:#E1E4E8;">).has(</span><span style="color:#9ECBFF;">&#39;Observation&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;patient&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">code</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;8310-5&#39;</span><span style="color:#E1E4E8;">).fetch()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">await</span><span style="color:#24292E;"> client.resources(</span><span style="color:#032F62;">&#39;Patient&#39;</span><span style="color:#24292E;">).has(</span><span style="color:#032F62;">&#39;Observation&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;patient&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">code</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;8310-5&#39;</span><span style="color:#24292E;">).fetch()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>This query returns all of the temperature <code>Observation&#39;s</code> Patient resources from the database.</p><h2 id="summary" tabindex="-1">Summary <a class="header-anchor" href="#summary" aria-label="Permalink to &quot;Summary&quot;">​</a></h2><p>From this tutorial we will more familar with:</p><ul><li>Load observations from the HAPI FHIR server.</li><li>Create Observation records.</li><li>Srearch releted resources.</li><li>Display different Resource&#39;s attributes.</li></ul>',83)];const r=s(p,[["render",function(s,l,e,p,r,t){return n(),a("div",null,o)}]]);export{e as __pageData,r as default};
